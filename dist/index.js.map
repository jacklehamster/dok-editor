{"version":3,"file":"index.js","sources":["../src/language/lang-utils.ts","../src/editor/node-renderer.tsx","../src/editor/obj-editor.tsx","../src/editor/Select.tsx","../src/language/use-code.ts","../src/editor/dok-editor.tsx"],"sourcesContent":["import { parse, stringify } from \"yaml\";\n\nexport type Language = 'yaml'|'json'|string;\n\nexport function getObject(code: string, lang: 'yaml'|'json'|string) {\n    return lang === 'yaml' ? parse(code) : lang === 'json' ? JSON.parse(code): {};\n}\n\nexport function updateCodeForLanguage(code: string, previousLanguage: string, language: string): string | undefined {\n    const obj = getObject(code, previousLanguage);\n    const newLang = language;\n    if (newLang === 'yaml') {\n        return stringify(obj);\n    } else if(newLang === 'json') {\n        return JSON.stringify(obj, null, \"  \") + \"\\n\";\n    }\n    return;\n}\n","import React from \"react\";\n\ninterface Props {\n    obj: any;\n}\n\nexport function NodeRenderer({obj}: Props) {\n    const entries = !obj ? [] : Object.entries(obj);\n    return <div>\n        {entries.map(([key, value]) => {\n            return <div key={key} style={{ marginLeft: 5, backgroundColor: Array.isArray(obj) ? \"lemonchiffon\" : \"beige\"}}>\n                <div style={{ border: Array.isArray(obj) ? 1 : 0, marginTop: 5, borderStyle: \"solid\", padding: 5, display: typeof(value) === \"object\" ? \"block\" : \"flex\" }}>\n                    {!Array.isArray(obj) && <div style={{ backgroundColor: \"yellow\", borderRadius: 10, paddingLeft: 10, paddingRight: 10, width: \"fit-content\", height: \"fit-content\" }}>{key}: </div>}\n                    <div>\n                        {typeof(value) === \"object\" ? <NodeRenderer obj={value} /> : \"\" + value}\n                    </div>\n                </div>\n            </div>;\n        })}\n    </div>;\n}","import React, { useMemo } from \"react\";\nimport { Language, getObject } from \"../language/lang-utils\";\nimport { NodeRenderer } from \"./node-renderer\";\ninterface Props {\n    language: Language;\n    code: string;\n}\n\nexport function ObjEditor({language, code}:Props) {\n    const obj = useMemo(() => getObject(code, language), [code, language]);\n    return <NodeRenderer obj={obj} />;\n}","import React, { useMemo, useState } from \"react\";\nimport { Language } from \"../language/lang-utils\";\n\ninterface Props {\n    setEditor(value: boolean): void;\n    setLanguage(lang: Language): void;\n}\n\ntype Options = \"yaml\"|\"json\"|\"editor\"|string;\n\nexport function Select({ setEditor, setLanguage }: Props) {\n    const [option, setOption] = useState<Options>(\"yaml\");\n    const options = useMemo(() => ({\n        \"yaml\": (option: Options) => {\n            setEditor(false); setLanguage(option);\n            setOption(option);\n        },\n        \"json\": (option: Options) => {\n            setEditor(false); setLanguage(option);\n            setOption(option);\n        },\n        \"editor\": (option: Options) => {\n            setEditor(true);\n            setOption(option);\n        },\n    }), [setEditor, setLanguage]);\n\n    return <div style={{ display: \"flex\", flexDirection: \"row\", gap: 10 }}>\n        {Object.entries(options).map(([key, action]) => {\n            const selected = key === option;\n            return <div key={key} \n                style={{\n                    margin: 5,\n                    padding: 5,\n                    backgroundColor: selected ? \"black\" : undefined,\n                    color: selected ? \"snow\" : \"blue\",\n                    cursor: selected ? undefined : \"pointer\",\n                }}\n                onClick={() => action(key)}>{key}</div>;\n        })}\n    </div>\n}","import { useCallback, useState } from \"react\";\nimport { Language, updateCodeForLanguage } from \"./lang-utils\";\n\ninterface Props {\n    initialLanguage?: Language;\n    initialCode?: string;\n}\n\nexport function useCode({ initialLanguage = \"yaml\", initialCode }: Props = {}) {\n    const [language, setLanguage] = useState<\"yaml\"|\"json\"|string>(initialLanguage);\n    const [code, setCode] = useState(initialCode ?? \"null\");\n    return {\n        language,\n        setLanguage: useCallback((newLang: Language) => {\n            setLanguage(oldLanguage => {\n                setCode(code => {\n                    return updateCodeForLanguage(code, oldLanguage, newLang) ?? \"\";\n                });\n                return newLang;\n            });\n        }, [setCode, setLanguage]),\n        code,\n        setCode,\n    }\n}","import React, { useCallback, useEffect, useState } from \"react\";\nimport { Language } from \"../language/lang-utils\";\nimport { Editor } from '@monaco-editor/react';\nimport { ObjEditor } from \"./obj-editor\";\nimport { Select } from \"./Select\";\nimport { useCode } from \"../language/use-code\";\n\ninterface Props {\n    code?: string;\n    onCodeChange?(code: string): void;\n    language?: Language;\n    onLanguageChange?(lang: Language): void;\n}\n\nexport function DokEditor({\n    code: codeChanged,\n    language: languageChanged,\n    onCodeChange,\n    onLanguageChange,\n}: Props = {}) {\n    const { language, setLanguage, code, setCode } = useCode({\n        initialCode: codeChanged,\n        initialLanguage: languageChanged,\n    });\n\n    useEffect(() => {\n        if (codeChanged) {\n            setCode(codeChanged);\n        }\n    }, [codeChanged, setCode]);\n\n    useEffect(() => {\n        if (languageChanged) {\n            setLanguage(languageChanged);\n        }\n    }, [languageChanged, setLanguage]);\n\n\n    const [editor, setEditor] = useState(false);\n    const updateCode = useCallback((value?: string) => {\n        setCode((code) => {\n            if (value && code !== value) {\n                setCode(value);\n                onCodeChange?.(value);\n                return value;\n            }\n            return code;\n        });\n    }, [onCodeChange, setCode]);\n\n    return <div>\n        <Select setEditor={setEditor} setLanguage={language => {\n            setLanguage(language);\n            onLanguageChange?.(language);\n        }} />\n        {!editor && <Editor height=\"80vh\" language={language} value={code} onChange={updateCode} />}\n        {editor && <ObjEditor code={code} language={language} />}\n    </div>;\n}"],"names":["getObject","code","lang","parse","JSON","updateCodeForLanguage","previousLanguage","language","obj","newLang","stringify","NodeRenderer","_ref","entries","Object","React","map","_ref2","key","value","style","marginLeft","backgroundColor","Array","isArray","border","marginTop","borderStyle","padding","display","borderRadius","paddingLeft","paddingRight","width","height","ObjEditor","useMemo","Select","setEditor","setLanguage","_useState","useState","option","setOption","options","yaml","json","editor","flexDirection","gap","action","selected","margin","undefined","color","cursor","onClick","useCode","_temp","_ref$initialLanguage","initialLanguage","initialCode","_useState2","setCode","useCallback","oldLanguage","_updateCodeForLanguag","DokEditor","codeChanged","languageChanged","onCodeChange","onLanguageChange","_useCode","useEffect","updateCode","Editor","onChange"],"mappings":";;;;;;;SAIgBA,SAASA,CAACC,IAAY,EAAEC,IAA0B;EAC9D,OAAOA,IAAI,KAAK,MAAM,GAAGC,UAAK,CAACF,IAAI,CAAC,GAAGC,IAAI,KAAK,MAAM,GAAGE,IAAI,CAACD,KAAK,CAACF,IAAI,CAAC,GAAE,EAAE;AACjF;SAEgBI,qBAAqBA,CAACJ,IAAY,EAAEK,gBAAwB,EAAEC,QAAgB;EAC1F,IAAMC,GAAG,GAAGR,SAAS,CAACC,IAAI,EAAEK,gBAAgB,CAAC;EAC7C,IAAMG,OAAO,GAAGF,QAAQ;EACxB,IAAIE,OAAO,KAAK,MAAM,EAAE;IACpB,OAAOC,cAAS,CAACF,GAAG,CAAC;GACxB,MAAM,IAAGC,OAAO,KAAK,MAAM,EAAE;IAC1B,OAAOL,IAAI,CAACM,SAAS,CAACF,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,GAAG,IAAI;;EAEjD;AACJ;;SCXgBG,YAAYA,CAAAC,IAAA;MAAEJ,GAAG,GAAAI,IAAA,CAAHJ,GAAG;EAC7B,IAAMK,OAAO,GAAG,CAACL,GAAG,GAAG,EAAE,GAAGM,MAAM,CAACD,OAAO,CAACL,GAAG,CAAC;EAC/C,OAAOO,0CACFF,OAAO,CAACG,GAAG,CAAC,UAAAC,KAAA;QAAEC,GAAG,GAAAD,KAAA;MAAEE,KAAK,GAAAF,KAAA;IACrB,OAAOF;MAAKG,GAAG,EAAEA,GAAG;MAAEE,KAAK,EAAE;QAAEC,UAAU,EAAE,CAAC;QAAEC,eAAe,EAAEC,KAAK,CAACC,OAAO,CAAChB,GAAG,CAAC,GAAG,cAAc,GAAG;;OACjGO;MAAKK,KAAK,EAAE;QAAEK,MAAM,EAAEF,KAAK,CAACC,OAAO,CAAChB,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;QAAEkB,SAAS,EAAE,CAAC;QAAEC,WAAW,EAAE,OAAO;QAAEC,OAAO,EAAE,CAAC;QAAEC,OAAO,EAAE,OAAOV,KAAM,KAAK,QAAQ,GAAG,OAAO,GAAG;;OAC7I,CAACI,KAAK,CAACC,OAAO,CAAChB,GAAG,CAAC,IAAIO;MAAKK,KAAK,EAAE;QAAEE,eAAe,EAAE,QAAQ;QAAEQ,YAAY,EAAE,EAAE;QAAEC,WAAW,EAAE,EAAE;QAAEC,YAAY,EAAE,EAAE;QAAEC,KAAK,EAAE,aAAa;QAAEC,MAAM,EAAE;;OAAkBhB,GAAG,OAAS,EAClLH,0CACK,OAAOI,KAAM,KAAK,QAAQ,GAAGJ,6BAACJ,YAAY;MAACH,GAAG,EAAEW;MAAS,GAAG,EAAE,GAAGA,KAAK,CACrE,CACJ,CACJ;GACT,CAAC,CACA;AACV;;SCZgBgB,SAASA,CAAAvB,IAAA;MAAEL,QAAQ,GAAAK,IAAA,CAARL,QAAQ;IAAEN,IAAI,GAAAW,IAAA,CAAJX,IAAI;EACrC,IAAMO,GAAG,GAAG4B,aAAO,CAAC;IAAA,OAAMpC,SAAS,CAACC,IAAI,EAAEM,QAAQ,CAAC;KAAE,CAACN,IAAI,EAAEM,QAAQ,CAAC,CAAC;EACtE,OAAOQ,6BAACJ,YAAY;IAACH,GAAG,EAAEA;IAAO;AACrC;;SCDgB6B,MAAMA,CAAAzB,IAAA;MAAG0B,SAAS,GAAA1B,IAAA,CAAT0B,SAAS;IAAEC,WAAW,GAAA3B,IAAA,CAAX2B,WAAW;EAC3C,IAAAC,SAAA,GAA4BC,cAAQ,CAAU,MAAM,CAAC;IAA9CC,MAAM,GAAAF,SAAA;IAAEG,SAAS,GAAAH,SAAA;EACxB,IAAMI,OAAO,GAAGR,aAAO,CAAC;IAAA,OAAO;MAC3B,MAAM,EAAE,SAAAS,KAACH,MAAe;QACpBJ,SAAS,CAAC,KAAK,CAAC;QAAEC,WAAW,CAACG,MAAM,CAAC;QACrCC,SAAS,CAACD,MAAM,CAAC;OACpB;MACD,MAAM,EAAE,SAAAI,KAACJ,MAAe;QACpBJ,SAAS,CAAC,KAAK,CAAC;QAAEC,WAAW,CAACG,MAAM,CAAC;QACrCC,SAAS,CAACD,MAAM,CAAC;OACpB;MACD,QAAQ,EAAE,SAAAK,OAACL,MAAe;QACtBJ,SAAS,CAAC,IAAI,CAAC;QACfK,SAAS,CAACD,MAAM,CAAC;;KAExB;GAAC,EAAE,CAACJ,SAAS,EAAEC,WAAW,CAAC,CAAC;EAE7B,OAAOxB;IAAKK,KAAK,EAAE;MAAES,OAAO,EAAE,MAAM;MAAEmB,aAAa,EAAE,KAAK;MAAEC,GAAG,EAAE;;KAC5DnC,MAAM,CAACD,OAAO,CAAC+B,OAAO,CAAC,CAAC5B,GAAG,CAAC,UAAAC,KAAA;QAAEC,GAAG,GAAAD,KAAA;MAAEiC,MAAM,GAAAjC,KAAA;IACtC,IAAMkC,QAAQ,GAAGjC,GAAG,KAAKwB,MAAM;IAC/B,OAAO3B;MAAKG,GAAG,EAAEA,GAAG;MAChBE,KAAK,EAAE;QACHgC,MAAM,EAAE,CAAC;QACTxB,OAAO,EAAE,CAAC;QACVN,eAAe,EAAE6B,QAAQ,GAAG,OAAO,GAAGE,SAAS;QAC/CC,KAAK,EAAEH,QAAQ,GAAG,MAAM,GAAG,MAAM;QACjCI,MAAM,EAAEJ,QAAQ,GAAGE,SAAS,GAAG;OAClC;MACDG,OAAO,EAAE,SAAAA;QAAA,OAAMN,MAAM,CAAChC,GAAG,CAAC;;OAAGA,GAAG,CAAO;GAC9C,CAAC,CACA;AACV;;SCjCgBuC,OAAOA,CAAAC,KAAA;gCAAoD,EAAE,GAAAA,KAAA;IAAAC,oBAAA,GAAA/C,IAAA,CAAnDgD,eAAe;IAAfA,eAAe,GAAAD,oBAAA,cAAG,MAAM,GAAAA,oBAAA;IAAEE,WAAW,GAAAjD,IAAA,CAAXiD,WAAW;EAC3D,IAAArB,SAAA,GAAgCC,cAAQ,CAAuBmB,eAAe,CAAC;IAAxErD,QAAQ,GAAAiC,SAAA;IAAED,WAAW,GAAAC,SAAA;EAC5B,IAAAsB,UAAA,GAAwBrB,cAAQ,CAACoB,WAAW,WAAXA,WAAW,GAAI,MAAM,CAAC;IAAhD5D,IAAI,GAAA6D,UAAA;IAAEC,OAAO,GAAAD,UAAA;EACpB,OAAO;IACHvD,QAAQ,EAARA,QAAQ;IACRgC,WAAW,EAAEyB,iBAAW,CAAC,UAACvD,OAAiB;MACvC8B,WAAW,CAAC,UAAA0B,WAAW;QACnBF,OAAO,CAAC,UAAA9D,IAAI;;UACR,QAAAiE,qBAAA,GAAO7D,qBAAqB,CAACJ,IAAI,EAAEgE,WAAW,EAAExD,OAAO,CAAC,YAAAyD,qBAAA,GAAI,EAAE;SACjE,CAAC;QACF,OAAOzD,OAAO;OACjB,CAAC;KACL,EAAE,CAACsD,OAAO,EAAExB,WAAW,CAAC,CAAC;IAC1BtC,IAAI,EAAJA,IAAI;IACJ8D,OAAO,EAAPA;GACH;AACL;;SCVgBI,SAASA,CAAAT,KAAA;gCAKd,EAAE,GAAAA,KAAA;IAJHU,WAAW,GAAAxD,IAAA,CAAjBX,IAAI;IACMoE,eAAe,GAAAzD,IAAA,CAAzBL,QAAQ;IACR+D,YAAY,GAAA1D,IAAA,CAAZ0D,YAAY;IACZC,gBAAgB,GAAA3D,IAAA,CAAhB2D,gBAAgB;EAEhB,IAAAC,QAAA,GAAiDf,OAAO,CAAC;MACrDI,WAAW,EAAEO,WAAW;MACxBR,eAAe,EAAES;KACpB,CAAC;IAHM9D,QAAQ,GAAAiE,QAAA,CAARjE,QAAQ;IAAEgC,YAAW,GAAAiC,QAAA,CAAXjC,WAAW;IAAEtC,IAAI,GAAAuE,QAAA,CAAJvE,IAAI;IAAE8D,OAAO,GAAAS,QAAA,CAAPT,OAAO;EAK5CU,eAAS,CAAC;IACN,IAAIL,WAAW,EAAE;MACbL,OAAO,CAACK,WAAW,CAAC;;GAE3B,EAAE,CAACA,WAAW,EAAEL,OAAO,CAAC,CAAC;EAE1BU,eAAS,CAAC;IACN,IAAIJ,eAAe,EAAE;MACjB9B,YAAW,CAAC8B,eAAe,CAAC;;GAEnC,EAAE,CAACA,eAAe,EAAE9B,YAAW,CAAC,CAAC;EAGlC,IAAAC,SAAA,GAA4BC,cAAQ,CAAC,KAAK,CAAC;IAApCM,MAAM,GAAAP,SAAA;IAAEF,SAAS,GAAAE,SAAA;EACxB,IAAMkC,UAAU,GAAGV,iBAAW,CAAC,UAAC7C,KAAc;IAC1C4C,OAAO,CAAC,UAAC9D,IAAI;MACT,IAAIkB,KAAK,IAAIlB,IAAI,KAAKkB,KAAK,EAAE;QACzB4C,OAAO,CAAC5C,KAAK,CAAC;QACdmD,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAGnD,KAAK,CAAC;QACrB,OAAOA,KAAK;;MAEhB,OAAOlB,IAAI;KACd,CAAC;GACL,EAAE,CAACqE,YAAY,EAAEP,OAAO,CAAC,CAAC;EAE3B,OAAOhD,0CACHA,6BAACsB,MAAM;IAACC,SAAS,EAAEA,SAAS;IAAEC,WAAW,EAAE,SAAAA,YAAAhC,QAAQ;MAC/CgC,YAAW,CAAChC,QAAQ,CAAC;MACrBgE,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAGhE,QAAQ,CAAC;;IAC3B,EACJ,CAACwC,MAAM,IAAIhC,6BAAC4D,YAAM;IAACzC,MAAM,EAAC,MAAM;IAAC3B,QAAQ,EAAEA,QAAQ;IAAEY,KAAK,EAAElB,IAAI;IAAE2E,QAAQ,EAAEF;IAAc,EAC1F3B,MAAM,IAAIhC,6BAACoB,SAAS;IAAClC,IAAI,EAAEA,IAAI;IAAEM,QAAQ,EAAEA;IAAY,CACtD;AACV;;;;;;;"}